{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?9b05","webpack:///./src/App.vue?48be","webpack:///./src/ws.js","webpack:///./src/Feed.js","webpack:///src/App.vue","webpack:///./src/App.vue?a7d1","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","_v","attrs","socketUrl","globalWs","WebSocket","handleGetBarsMessage","filteringTime","time","minuteTime","dayTime","longTime","parseInt","transformTime","period","indexOf","hourNumber","Math","floor","handleBuffer","buffer","onHistoryCallback","handleJson","e","JSON","parse","type","klineData","kLine","bars","obj","high","h","open","low","close","volumn","v","console","log","Feed","url","subs","feedConfig","supports_search","supports_group_request","supports_marks","exchanges","desc","symbols_types","supported_resolutions","callback","fetch","response","json","symbolInfo","resolution","from","to","onErrorCallback","firstDataRequest","removeEventListener","msg","wesocketGetData","soketParams","baseCurrencyId","targetCurrencyId","isSendws","send","stringify","addEventListener","onRealtimeCallback","subscriberUID","onResetCacheNeededCallback","userInput","exchange","symbolType","onResultReadyCallback","symbolName","onSymbolResolvedCallback","onResolveErrorCallback","ticker","description","session","holidays","corrections","timezone","minmov","minmov2","pointvalue","pricescale","has_intraday","intraday_multipliers","has_daily","has_empty_bars","has_no_volume","has_weekly_and_monthly","components","mounted","TradingView","widget","container_id","locale","datafeed","fullscreen","overrides","interval","component","Vue","config","productionTip","render","App","$mount"],"mappings":"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","file":"js/app.437ece81.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/tradingview/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"tradingview-vue\")]),_c('div',{attrs:{\"id\":\"app\"}})])}]\n\nexport { render, staticRenderFns }","const socketUrl = \"ws://localhost:3002\";\nconst globalWs = new WebSocket(socketUrl);\nexport default globalWs;\n","import globalWs from \"./ws\";\n// 处理二进制流\n\nlet handleGetBarsMessage = null;\n\n// 处理时间\nconst filteringTime = (time) => {\n  const minuteTime = 60;\n  const dayTime = 60 * 60 * 24;\n  let longTime = 0;\n  switch (time) {\n    case \"1D\":\n      longTime = dayTime * 1;\n      break;\n    case \"1W\":\n      longTime = dayTime * 7;\n      break;\n    case \"1M\":\n      longTime = dayTime * 30;\n      break;\n    default:\n      longTime = parseInt(time) * minuteTime;\n      break;\n  }\n  return longTime;\n};\n\nconst transformTime = (time) => {\n  let period = \"\";\n  if (\n    time.indexOf(\"D\") !== -1 ||\n    time.indexOf(\"W\") !== -1 ||\n    time.indexOf(\"M\") !== -1\n  ) {\n    period = time;\n  } else if (parseInt(time) < 60) {\n    period = `${time}min`;\n  } else if (parseInt(time) <= 720) {\n    const hourNumber = Math.floor(parseInt(time) / 60);\n    period = `${hourNumber}hour`;\n  }\n\n  return period;\n};\n// 处理websocket二进制数据\nconst handleBuffer = (buffer, onHistoryCallback) => {};\n// 处理websocket json数据\nconst handleJson = (e, onHistoryCallback) => {\n  let data = JSON.parse(e);\n  if (data.type === \"kline\") {\n    let klineData = data.data.kLine;\n    let bars = [];\n    for (let i = 0, length = klineData.c.length; i < length; i++) {\n      let obj = {};\n      obj.high = klineData.h[i];\n      obj.open = klineData.o[i];\n      obj.low = klineData.l[i];\n      obj.close = klineData.c[i];\n      obj.volumn = klineData.v[i];\n      obj.time = klineData.t[i] * 1000;\n      bars.push(obj);\n    }\n    console.log(\"ws message---\", bars);\n    onHistoryCallback(bars);\n  }\n};\n\nexport class Feed {\n  constructor(url) {\n    this.subs = {};\n    this.url = url;\n    this.feedConfig = {\n      supports_search: true,\n      supports_group_request: false,\n      supports_marks: true,\n      exchanges: [\n        { value: \"\", name: \"All Exchanges\", desc: \"\" },\n        { value: \"XETRA\", name: \"XETRA\", desc: \"XETRA\" },\n        { value: \"NSE\", name: \"NSE\", desc: \"NSE\" },\n      ],\n      symbols_types: [\n        { name: \"All types\", value: \"\" },\n        { name: \"Stock\", value: \"stock\" },\n        { name: \"Index\", value: \"index\" },\n      ],\n      supported_resolutions: [\n        \"1\",\n        \"15\",\n        \"30\",\n        \"60\",\n        \"D\",\n        \"2D\",\n        \"3D\",\n        \"W\",\n        \"3W\",\n        \"M\",\n        \"6M\",\n      ],\n    };\n  }\n  async onReady(callback) {\n    console.log(\"onready\");\n    let response = await fetch(this.url + \"/config\");\n    let json = await response.json();\n    json.supported_resolutions = [\n      \"1\",\n      \"5\",\n      \"15\",\n      \"30\",\n      \"60\",\n      \"120\",\n      \"240\",\n      \"360\",\n      \"720\",\n      \"1D\",\n      \"1W\",\n      \"1M\",\n    ];\n    console.log(\"set json\");\n    callback(json);\n  }\n  getBars(\n    symbolInfo,\n    resolution,\n    from,\n    to,\n    onHistoryCallback,\n    onErrorCallback,\n    firstDataRequest\n  ) {\n    console.log(\"getbars -----\", resolution);\n    from *= 1000;\n    to *= 1000;\n    const resolutionTime = filteringTime(resolution);\n    const period = transformTime(resolution);\n    // getBars websoket事件处理函数，单独提取出来，防止跟其他的onmessage冲突\n    // 放在该函数内部，是为了使用onHistoryCallback\n    // getBars会多次调用，需要先移除监听\n    handleGetBarsMessage &&\n      globalWs.removeEventListener(\"message\", handleGetBarsMessage);\n    handleGetBarsMessage = (msg) => {\n      if (typeof msg.data === \"object\") {\n        handleBuffer(msg.data, onHistoryCallback);\n      } else {\n        handleJson(msg.data, onHistoryCallback);\n      }\n    };\n    //   使用websocket传输数据\n    const wesocketGetData = () => {\n      const soketParams = {\n        type: \"kline\",\n        period,\n        from, // 开始时间戳\n        to, // 结束时间戳\n        baseCurrencyId: 1, // 基准货币主键\n        targetCurrencyId: 2, // 目标货币主键\n      };\n\n      if (!window.isSendws) {\n        globalWs.send(JSON.stringify(soketParams));\n        window.isSendws = true;\n      }\n      globalWs.addEventListener(\"message\", handleGetBarsMessage);\n    };\n    //   使用http传输数据\n    const httpGetData = () => {};\n    wesocketGetData();\n  }\n  // 数据订阅\n  subscribeBars(\n    symbolInfo,\n    resolution,\n    onRealtimeCallback,\n    subscriberUID,\n    onResetCacheNeededCallback\n  ) {\n    console.log(\"订阅者\", subscriberUID);\n    if (this.subs[subscriberUID]) {\n      return;\n    } else {\n      this.subs[subscriberUID] = {\n        symbolInfo,\n        resolution,\n        onRealtimeCallback,\n      };\n    }\n  }\n  //   取消订阅\n  unsubscribeBars(subscriberUID) {\n    delete this.subs[subscriberUID];\n  }\n  //   用户搜索商品触发\n  async searchSymbols(userInput, exchange, symbolType, onResultReadyCallback) {\n    console.log(\"search symbol\", exchange, symbolType);\n    let response = await fetch(\n      this.url + `search?query=${userInput}&type=stock&exchange=NYSE&limit=15`\n    );\n    let json = await response.json();\n    onResultReadyCallback(json);\n  }\n  //   商品详情\n  async resolveSymbol(\n    symbolName,\n    onSymbolResolvedCallback,\n    onResolveErrorCallback\n  ) {\n    console.log(\"resolve symbol\", symbolName);\n    let response = await fetch(this.url + `/symbols?symbol=${symbolName}`);\n    let json = await response.json();\n    onSymbolResolvedCallback({\n      name: json.name,\n      ticker: json.ticker,\n      description: json.description,\n      type: json.type,\n      session: \"24x7\",\n      holidays: [],\n      corrections: [],\n      timezone: json.timezone,\n      // \"exchange-traded\": json[\"exchange-traded\"],\n      // \"exchange-listed\": json[\"exchange-listed\"],\n      minmov: json.minmov,\n      minmov2: json.minmov2,\n      pointvalue: json.pointvalue,\n      pricescale: json.pricescale,\n      has_intraday: true,\n      intraday_multipliers: [\"1\", \"5\", \"15\", \"30\", \"60\", \"240\"],\n      has_daily: true,\n      has_empty_bars: false,\n      has_no_volume: false,\n      has_weekly_and_monthly: true,\n      supported_resolutions: [\n        \"1\",\n        \"5\",\n        \"15\",\n        \"30\",\n        \"60\",\n        \"120\",\n        \"240\",\n        \"360\",\n        \"720\",\n        \"1D\",\n        \"1W\",\n        \"1M\",\n      ],\n    });\n  }\n}\n","<template>\n  <div>\n    <h1>tradingview-vue</h1>\n    <div id=\"app\"></div>\n  </div>\n</template>\n\n<script>\nimport ws from \"./ws\";\nimport { Feed } from \"./Feed\";\nexport default {\n  name: \"App\",\n  components: {},\n  mounted() {\n    new TradingView.widget({\n      container_id: \"app\",\n      locale: \"zh\",\n      datafeed: new Feed(\"https://demo_feed.tradingview.com/\"),\n      fullscreen: true,\n      overrides: {},\n      interval: 1,\n      // disabled_features: [\"header_symbol_search\"],\n    });\n  },\n};\n</script>\n\n<style>\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n}\n#app {\n  width: 100%;\n  height: 100%;\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=42b85a4a&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n"],"sourceRoot":""}