(function(e){function n(n){for(var r,s,i=n[0],c=n[1],u=n[2],p=0,f=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&f.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(n);while(f.length)f.shift()();return a.push.apply(a,u||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,i=1;i<t.length;i++){var c=t[i];0!==o[c]&&(r=!1)}r&&(a.splice(n--,1),e=s(s.s=t[0]))}return e}var r={},o={app:0},a=[];function s(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=r,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)s.d(t,r,function(n){return e[n]}.bind(null,r));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/tradingview/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var u=0;u<i.length;u++)n(i[u]);var l=c;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";var r=t("85ec"),o=t.n(r);o.a},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var r=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}})},a=[],s="ws://localhost:3002",i=new WebSocket(s),c=i,u=(t("a4d3"),t("e01a"),t("c975"),t("b0c0"),t("d3b7"),t("53ca")),l=(t("96cf"),t("1da1")),p=t("d4ec"),f=t("bee2"),d=null,v=function(e){var n=60,t=86400,r=0;switch(e){case"1D":r=1*t;break;case"1W":r=7*t;break;case"1M":r=30*t;break;default:r=parseInt(e)*n;break}return r},h=function(e){var n="";if(-1!==e.indexOf("D")||-1!==e.indexOf("W")||-1!==e.indexOf("M"))n=e;else if(parseInt(e)<60)n="".concat(e,"min");else if(parseInt(e)<=720){var t=Math.floor(parseInt(e)/60);n="".concat(t,"hour")}return n},m=function(e,n){},b=function(e,n){var t=JSON.parse(e);if("kline"===t.type){for(var r=t.data.kLine,o=[],a=0,s=r.c.length;a<s;a++){var i={};i.high=r.h[a],i.open=r.o[a],i.low=r.l[a],i.close=r.c[a],i.volumn=r.v[a],i.time=1e3*r.t[a],o.push(i)}console.log("ws message---",o),n(o)}},y=function(){function e(n){Object(p["a"])(this,e),this.subs={},this.url=n,this.feedConfig={supports_search:!0,supports_group_request:!1,supports_marks:!0,exchanges:[{value:"",name:"All Exchanges",desc:""},{value:"XETRA",name:"XETRA",desc:"XETRA"},{value:"NSE",name:"NSE",desc:"NSE"}],symbols_types:[{name:"All types",value:""},{name:"Stock",value:"stock"},{name:"Index",value:"index"}],supported_resolutions:["1","15","30","60","D","2D","3D","W","3W","M","6M"]}}return Object(f["a"])(e,[{key:"onReady",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(n){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("onready"),e.next=3,fetch(this.url+"/config");case 3:return t=e.sent,e.next=6,t.json();case 6:r=e.sent,r.supported_resolutions=["1","5","15","30","60","120","240","360","720","1D","1W","1M"],console.log("set json"),n(r);case 10:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getBars",value:function(e,n,t,r,o,a,s){console.log("getbars -----",n),t*=1e3,r*=1e3;v(n);var i=h(n);d&&c.removeEventListener("message",d),d=function(e){"object"===Object(u["a"])(e.data)?m(e.data,o):b(e.data,o)};var l=function(){var e={type:"kline",period:i,from:t,to:r,baseCurrencyId:1,targetCurrencyId:2};window.isSendws||(c.send(JSON.stringify(e)),window.isSendws=!0),c.addEventListener("message",d)};l()}},{key:"subscribeBars",value:function(e,n,t,r,o){console.log("订阅者",r),this.subs[r]||(this.subs[r]={symbolInfo:e,resolution:n,onRealtimeCallback:t})}},{key:"unsubscribeBars",value:function(e){delete this.subs[e]}},{key:"searchSymbols",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(n,t,r,o){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("search symbol",t,r),e.next=3,fetch(this.url+"search?query=".concat(n,"&type=stock&exchange=NYSE&limit=15"));case 3:return a=e.sent,e.next=6,a.json();case 6:s=e.sent,o(s);case 8:case"end":return e.stop()}}),e,this)})));function n(n,t,r,o){return e.apply(this,arguments)}return n}()},{key:"resolveSymbol",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(n,t,r){var o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("resolve symbol",n),e.next=3,fetch(this.url+"/symbols?symbol=".concat(n));case 3:return o=e.sent,e.next=6,o.json();case 6:a=e.sent,t({name:a.name,ticker:a.ticker,description:a.description,type:a.type,session:"24x7",holidays:[],corrections:[],timezone:a.timezone,minmov:a.minmov,minmov2:a.minmov2,pointvalue:a.pointvalue,pricescale:a.pricescale,has_intraday:!0,intraday_multipliers:["1","5","15","30","60","240"],has_daily:!0,has_empty_bars:!1,has_no_volume:!1,has_weekly_and_monthly:!0,supported_resolutions:["1","5","15","30","60","120","240","360","720","1D","1W","1M"]});case 8:case"end":return e.stop()}}),e,this)})));function n(n,t,r){return e.apply(this,arguments)}return n}()}]),e}(),g={name:"App",components:{},mounted:function(){new TradingView.widget({container_id:"app",locale:"zh",datafeed:new y("https://demo_feed.tradingview.com/"),fullscreen:!0,overrides:{},interval:1})}},w=g,k=(t("034f"),t("2877")),_=Object(k["a"])(w,o,a,!1,null,null,null),x=_.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(x)}}).$mount("#app")},"85ec":function(e,n,t){}});
//# sourceMappingURL=app.afdd8038.js.map